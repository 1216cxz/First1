import streamlit as st
import pandas as pd

st.set_page_config(page_title="2025ë…„ 6ì›” êµí†µì¹´ë“œ í†µê³„ ë¶„ì„", layout="wide")
st.title("ğŸšŒ 2025ë…„ 6ì›” êµí†µì¹´ë“œ í†µê³„ ë¶„ì„")

# íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°
try:
    df = pd.read_excel("data/2025ë…„_06ì›”_êµí†µì¹´ë“œ_í†µê³„ìë£Œ.xls", header=2)  # ì‹œíŠ¸ êµ¬ì¡°ì— ë§ê²Œ ìˆ˜ì • ê°€ëŠ¥
except Exception as e:
    st.error(f"íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {e}")
    st.stop()

# ë°ì´í„° í™•ì¸
st.subheader("ğŸ“‹ ì›ë³¸ ë°ì´í„° (ë¯¸ë¦¬ë³´ê¸°)")
st.dataframe(df.head())

# ì˜ˆì‹œ: ë…¸ì„ ë³„ ì´ìš©ì ìˆ˜ ë¶„ì„
if 'ë…¸ì„ ëª…' in df.columns and 'í•©ê³„' in df.columns:
    df_top = df.sort_values('í•©ê³„', ascending=False).head(10)
    st.subheader("ğŸš ì´ìš©ê° ìˆ˜ TOP 10 ë…¸ì„ ")
    st.bar_chart(df_top.set_index("ë…¸ì„ ëª…")['í•©ê³„'])
else:
    st.warning("ë…¸ì„ ëª… ë˜ëŠ” í•©ê³„ ì—´ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë°ì´í„° êµ¬ì¡°ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.")
